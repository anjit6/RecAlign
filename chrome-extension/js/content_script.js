(()=>{"use strict";const e=new Map;function t(e){const t=e.getBoundingClientRect(),n=Math.max(document.documentElement.clientHeight,window.innerHeight);return!(t.bottom<0||t.top-n>=0)}let n=!1;setInterval((()=>{n||(n=!0,"https://twitter.com/home"===window.location.href||"https://www.twitter.com/home"===window.location.href?chrome.storage.sync.get(["twitter"]).then((n=>{if(null==n.twitter&&(n.twitter=!0),n.twitter){const n=document.querySelectorAll("article[data-testid='tweet']"),o=[],s=Array.prototype.filter.call(n,(e=>t(e))),i=[],r=[];for(let t=0;t<s.length;t++){const n=s[t].querySelector("div[data-testid='tweetText']");if(null==n){o.push("");continue}const a=n.textContent.replaceAll("\n","");o.push(a);const l=s[t].closest("div[data-testid='cellInnerDiv']");!e.has(o[t])&&l&&(l.style.opacity="0.3"),e.has(a)||(i.push(a),r.push(s[t]))}if(0==i.length)return;chrome.storage.sync.get(["preference","openai_api_key"]).then((t=>{const n={messages:i,preference:t.preference,openai_api_key:t.openai_api_key},r=new XMLHttpRequest;r.open("POST","https://hiubwe6637gmpslsccd4ofi3de0yaeqa.lambda-url.us-east-2.on.aws/"),r.setRequestHeader("Content-Type","application/json;charset=UTF-8"),r.send(JSON.stringify(n)),r.onloadend=function(){const t=JSON.parse(r.responseText);for(let n=0;n<t.length;n++)e.set(i[n],t[n]);for(let t=0;t<s.length;t++)e.has(o[t])&&(e.get(o[t])?s[t].closest("div[data-testid='cellInnerDiv']").style.opacity="1":s[t].closest("div[data-testid='cellInnerDiv']").style.display="none")}}))}})):"https://www.linkedin.com/feed/"===window.location.href||"https://linkedin.com/feed/"===window.location.href?chrome.storage.sync.get(["linkedin"]).then((n=>{if(null==n.linkedin&&(n.linkedin=!0),n.linkedin){const n=document.querySelectorAll("div.feed-shared-update-v2.artdeco-card"),o=[],s=Array.prototype.filter.call(n,(e=>t(e))),i=[],r=[];for(let t=0;t<s.length;t++){const n=s[t].querySelector("div.update-components-text.relative.feed-shared-update-v2__commentary");if(null==n){o.push("");continue}const a=n.textContent.replaceAll("\n","");o.push(a),e.has(o[t])||(s[t].style.opacity="0.3"),e.has(a)||(i.push(a),r.push(s[t]))}if(0==i.length)return;chrome.storage.sync.get(["preference","openai_api_key"]).then((t=>{const n={messages:i,preference:t.preference,openai_api_key:t.openai_api_key},r=new XMLHttpRequest;r.open("POST","https://hiubwe6637gmpslsccd4ofi3de0yaeqa.lambda-url.us-east-2.on.aws/"),r.setRequestHeader("Content-Type","application/json;charset=UTF-8"),r.send(JSON.stringify(n)),r.onloadend=function(){const t=JSON.parse(r.responseText);for(let n=0;n<t.length;n++)e.set(i[n],t[n]);for(let t=0;t<s.length;t++)e.has(o[t])&&(e.get(o[t])?s[t].style.opacity="1":s[t].style.display="none")}}))}})):"https://www.zhihu.com/"!==window.location.href&&"https://www.zhihu.com/follow"!==window.location.href||chrome.storage.sync.get(["zhihu"]).then((n=>{if(null==n.zhihu&&(n.zhihu=!0),n.zhihu){let n=document.querySelectorAll(".Card.TopstoryItem"),o=[],s=Array.prototype.filter.call(n,(function(e){return t(e)})),i=[],r=[];for(let t=0;t<s.length;t++){let a,l;const c=s[t].querySelector(".ContentItem");if(c&&c.dataset.zop){const e=JSON.parse(c.dataset.zop);a=e.authorName,l=e.title}else l=c.querySelector(".QuestionItem-title").textContent,a="";const p=`Author: ${a}, Title: ${l}, Body: ${c.querySelector(".RichText.ztext").textContent.replaceAll("\n","")}`;o.push(p),e.has(p)||(i.push(p),r.push(n[t]),s[t].style.opacity="0.3")}if(0==i.length)return;chrome.storage.sync.get(["preference","openai_api_key"]).then((t=>{const n=t.preference,r={messages:i,preference:n,openai_api_key:t.openai_api_key},a=new XMLHttpRequest;a.open("POST","https://hiubwe6637gmpslsccd4ofi3de0yaeqa.lambda-url.us-east-2.on.aws/"),a.setRequestHeader("Content-Type","application/json;charset=UTF-8"),a.send(JSON.stringify(r)),a.onloadend=function(){const t=JSON.parse(a.responseText);for(let n=0;n<t.length;n++)e.set(i[n],t[n]);for(let t=0;t<s.length;t++)e.has(o[t])&&(e.get(o[t])?s[t].style.opacity="1":s[t].style.display="none")}}))}})),n=!1)}),3e3)})();